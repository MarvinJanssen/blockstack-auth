<?php
require_once __DIR__ . "/../vendor/autoload.php";

use PHPUnit\Framework\TestCase;
use Blockstack\Authentication;

final class AuthTest extends TestCase
	{
	public function test_auth()
		{
		$auth_response = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NksifQ.eyJqdGkiOiI1Mjc4YTBkYS0zYzE2LTRhMGYtYmJhNi0wZGM1M2U3NjZlNGEiLCJpYXQiOjE1NjMzMjg4NzEsImV4cCI6MTU2NjAwNzI3MSwiaXNzIjoiZGlkOmJ0Yy1hZGRyOjE2RDFXaUNLdHplRFpGNGpxZ05WQktZaTRUUEhKWFRkc3oiLCJwcml2YXRlX2tleSI6IjdiMjI2OTc2MjIzYTIyNjEzNDYzMzQ2NjY0MzgzNzM4MzE2MzMwNjEzMzM0NjMzNjYzMzMzNDM4NjYzNjMxNjEzMDY2NjYzNDM5MzY2NTIyMmMyMjY1NzA2ODY1NmQ2NTcyNjE2YzUwNGIyMjNhMjIzMDMzNjYzNjMxMzg2MzYzMzg2NTYzMzMzNDY1MzQzNDM0MzUzMTM5MzEzODM0MzQ2MTMwNjYzNTMxMzAzNDM3MzIzNzMxMzUzOTMzNjYzNzM3MzEzNTM3MzczMTM0MzgzNjY0MzYzODM5MzM2NjM2MzE2NDY1MzUzNjY1MzQzMjMxMzUyMjJjMjI2MzY5NzA2ODY1NzI1NDY1Nzg3NDIyM2EyMjMxNjY2NjMzNjY2MzYxMzczNDMwMzQzNDMxNjE2MzMwMzMzNzY1MzUzNTY0Mzg2NTYyMzI2MjM0MzEzNTY1NjU2NDYyNjM2MzMxMzg2NDM1MzQzMjM5NjYzNTYzNjYzNjM4MzkzNTM3MzIzMjY1MzEzNDM2MzgzODY1MzIzMDMyNjEzODYxMzAzMjMyMzkzNjM5MzgzOTM2NjEzNDM1NjY2NDM0MzUzMzY0MzA2MzY0MzI2MTM1NjIzMzY1NjE2NDY0MzkzMjMzNjM2NTMzNjQ2MTM1MzUzMTM5MzEzMzM1MzEzNDM3MzkzMjM0MzAzMzM3MzM2NjMzNjYzNjM0MzMzNjY0NjEzMzM3NjE2NTMzNjE2NTMxNjY2MzY0MzA2MTYxNjMzMDMwMzAzNzM0NjI2NDM2NjMzMDMxNjM2MTY0MjIyYzIyNmQ2MTYzMjIzYTIyNjU2NTYyMzY2MjMzNjMzMjM1NjY2MzYzNjEzNjYyNjM2NjMzMzYzMDM5MzMzNjM0Mzc2NDMwNjUzMzY2NjEzNDY2MzgzODYyMzUzMzY0MzA2NTM2MzEzMDY0NjEzMjYyMzk2MTMwMzAzNzM3MzUzMTM3MzczMTY1MzUzNTYyNjMyMjJjMjI3NzYxNzM1Mzc0NzI2OTZlNjcyMjNhNzQ3Mjc1NjU3ZCIsInB1YmxpY19rZXlzIjpbIjAzMTU2NTFlYWMxNmI1N2VjZGFkZTczZmNjMjU3YTAxNWI1ODFjMDE5YjlkMzc0ODg0YjM5NTkwMmE1MjE4ZWViZSJdLCJwcm9maWxlIjpudWxsLCJ1c2VybmFtZSI6ImxvY2FsdGVzdGlkLmlkLmJsb2Nrc3RhY2siLCJjb3JlX3Rva2VuIjpudWxsLCJlbWFpbCI6bnVsbCwicHJvZmlsZV91cmwiOiJodHRwczovL2dhaWEuYmxvY2tzdGFjay5vcmcvaHViLzE2RDFXaUNLdHplRFpGNGpxZ05WQktZaTRUUEhKWFRkc3ovcHJvZmlsZS5qc29uIiwiaHViVXJsIjoiaHR0cHM6Ly9odWIuYmxvY2tzdGFjay5vcmciLCJibG9ja3N0YWNrQVBJVXJsIjpudWxsLCJhc3NvY2lhdGlvblRva2VuIjpudWxsLCJ2ZXJzaW9uIjoiMS4zLjEifQ.SbaH7O1vNzdCQlf5eOKOaNJxqWhmwm8_9tbj4_0HkQ00n9HNjsEBH9XBpbJRXFChK04KE5TfRTjzhjwILWixIQ';
		$this->assertEquals(true,Blockstack\Authentication::verify($auth_response,true));
		}
	}